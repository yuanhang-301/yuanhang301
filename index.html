<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8" />
		<title>PC项目</title>
		<link rel="stylesheet" type="text/css" href="css/index.css"/>
		<link rel="stylesheet" type="text/css" href="css/reset.css"/>
	</head>
	
				</div>
				<!-- 创建header下面的logo容器 -->
				<div class="bottom">
					<!-- 创建版心 -->
					<div class="banner">
						<!-- 左侧logo -->
						<div class="logo">
							<h1 title="尚品汇">
								<a href="">
									<img src="img/Logo.png" >
								</a>
							</h1>
						</div>
						<!-- 右侧搜索框 -->
						<div class="search">
							<input type="text" name="" id="" value="" />
							<button type="button">搜索</button>
						</div>
					</div>
				</div>
			</div>
			<!-- 全部商品分类导航菜单 -->
			<div class="typeNav">
				<!-- 版心 -->
				<div class="container">
					<div class="allGoods">
						全部商品分类
					</div>
					<div class="goods">
						<a href="">服装城</a><a
						 href="">美妆馆</a><a
						 href="">尚品汇超市</a><a
						 href="">全球购</a><a
						 href="">闪购</a><a
						 href="">团购</a><a
						 href="">有趣</a><a
						 href="">秒杀</a>
					</div>
				</div>
			</div>
			<!-- 商品主要内容区域 -->
			<div class="con">
				<!-- 路径导航区域 -->
				<div class="conPion">
					<a href="">手机、数码、通讯</a><i>/</i><a
					 href="">手机</a><i>/</i><a
					 href="">Apple苹果</a><i>/</i><a>iphone6s系列</a>
					 <!-- a去掉href时移入不会有效果 -->
				</div>
				<div class="mainCon">
					<!-- 左侧放大镜区域 -->
					<div class="previewWrap">
						<!-- 放大镜效果 -->
						<div class="preview">
							<div class="zoom">
								<a href=""><img src="img/s1.png" ></a>
							</div>
						</div>
						<!-- 小图 -->
						<div class="specScroll">
							<a class="prev" href=""><</a>
							<div class="itemCon">
								<ul>
									<li><img src="img/s1.png" ></li>
									<li><img src="img/s2.png" ></li>
									<li><img src="img/s3.png" ></li>
									<li><img src="img/s1.png" ></li>
									<li><img src="img/s2.png" ></li>
									<li><img src="img/s3.png" ></li>
									<li><img src="img/s1.png" ></li>
									<li><img src="img/s2.png" ></li>
									<li><img src="img/s3.png" ></li>
								</ul>
							</div>
							<a class="next" href="">></a>
						</div>
					</div>
					<!-- 右侧商品信息区域 -->
					<div class="infoWrap">
						<div class="info1">
							<h3 class="infoName">Apple iPhone 6s（A1700）64G玫瑰金色 移动通信电信4G手机</h3>
							<p class="news">推荐选择下方[移动优惠购],手机套餐齐搞定,不用换号,每月还有话费返</p>
							<div class="priceArea">
								<div class="priceArea1">
									<div class="title">价&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;格</div>
									<div class="price">
										<i>￥</i>
										<em>5299</em>
										<span>降价通知</span>
									</div>
									<div class="remark">
										<i>累计评价</i>
										<em>1244</em>
									</div>
								</div>
								<div class="priceArea2">
									<div class="title">促&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;销</div>
									<div class="fixWhith">
										<i class="add">加购价</i>
										<span>满999.00另加20.00元，或满1999.00另加30.00元，或满2999.00另加40.00元，即可在购物车换购热销商品</span>
									</div>
								</div>
							</div>
							<div class="support">
								<div>
									<p class="title">支&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;持</p>
									<span class="fixWhith">以旧换新，闲置手机回收 4G套餐超值抢 礼品购</span>
								</div>
								<div>
									<p class="title">配&nbsp;送&nbsp;至</p>
									<span class="fixWhith">广东省 深圳市 宝安区</span>
								</div>
							</div>
						</div>
						<div class="choose">
							<div class="chooseArea">
								<dl>
									<dt>选择颜色</dt>
									<dd>金色</dd>
									<dd>黑色</dd>
									<dd>银色</dd>
								</dl>
								<dl>
									<dt>内存容量</dt>
									<dd>16G</dd>
									<dd>64G</dd>
									<dd>128G</dd>
									<dd>256G</dd>
								</dl>
								<dl>
									<dt>选择版本</dt>
									<dd>公开版</dd>
									<dd>移动版</dd>
								</dl>
								<dl>
									<dt>购买方式</dt>
									<dd>官方标配</dd>
									<dd>优惠移动版</dd>
									<dd>电信优惠版</dd>
								</dl>
							</div>
							<div class="carWrap">
								<div class="controls">
									<input type="text" value="1"  />
									<a href="" class="plus">+</a>
									<a href="" class="mins">-</a>
								</div>
								<div class="addBtn">
									<a href="">加入购物车</a>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
		<script src="js/data.js" type="text/javascript" charset="utf-8"></script>
		<script type="text/javascript">
			// DOMContentLoaded等待节点加载完成之后执行
			window.addEventListener("DOMContentLoaded",function(){
				// 1.放大镜效果
				magnifier();
				function magnifier(){
					// 放大镜外层容器
					var preview=document.querySelector(".con .mainCon .previewWrap .preview");
					// 小图的容器
					var smallBox=document.querySelector(".con .mainCon .previewWrap .preview .zoom");
					// 初始化蒙版
					var mask=null;
					// 初始化大图容器
					var bigBox=null;
					// 初始化大图
					var bigImg=null;
					// 绑定鼠标移入移出事件
					preview.onmouseenter=function(){
						// 当鼠标移入元素时 创建蒙版(大图容器 大图 ) 没有蒙版创建 有有不创建
						if(!mask){
							// 创建蒙版
							mask=document.createElement("div");
							// 给蒙版一个class  并添加样式
							mask.className="mask";
							// 把蒙版插入到小图容器当中
							smallBox.appendChild(mask);
							// 创建大图和大图容器
							bigBox=document.createElement('div');
							bigBox.className="bigBox";
							// 创建大图 放入大图容器
							bigImg=new Image();
							bigImg.src="img/b1.png";
							bigBox.appendChild(bigImg);
							preview.appendChild(bigBox);
						}
						// 鼠标移动
						smallBox.onmousemove=function(event){
							// 当鼠标移动时 蒙版的位置是 鼠标坐标-蒙版的一半-父级left值
							var maskPosition={
								left:event.clientX-mask.offsetWidth/2-smallBox.getBoundingClientRect().left,
								top:event.clientY-mask.offsetHeight/2-smallBox.getBoundingClientRect().top
							};
							// 边界值判断 小于最小等于最小  大于最大等于最大
							if(maskPosition.left<0){
								maskPosition.left=0;
							}else if(maskPosition.left>smallBox.clientWidth-mask.offsetWidth){
								maskPosition.left=smallBox.clientWidth-mask.offsetWidth;
							}
							if(maskPosition.top<0){
								maskPosition.top=0;
							}else if(maskPosition.top>smallBox.clientHeight-mask.offsetHeight){
								maskPosition.top=smallBox.clientHeight-mask.offsetHeight;
							}
							// 对蒙版的位置进行操作
							mask.style.left=maskPosition.left+"px";
							mask.style.top=maskPosition.top+"px";
							
							// 计算比列  蒙版一共可以移动的距离/ 大图能够移动的距离
							var scale=(smallBox.clientWidth-mask.offsetWidth)/(bigImg.offsetWidth-bigBox.clientWidth)
							// 计算大图的位置
							var bigPosition={
								left:maskPosition.left/scale,
								top:maskPosition.top/scale
							}
							// 给大图修正位置
							bigImg.style.marginLeft=-bigPosition.left+"px";
							bigImg.style.marginTop=-bigPosition.top+"px";
						}
						// 当鼠标离开时 放大镜效果结束 清除蒙版  移除事件
						preview.onmouseleave=function(){
							// 移除节点
							smallBox.removeChild(mask);
							preview.removeChild(bigBox);
							// 初始化蒙版
							mask=null;
							bigBox=null;
							bigImg=null;
							// 解绑事件
							smallBox.onmousemove=null;
							preview.onmouseleave=null;
						}
					
					}
				}
				
				function getStyle(obj,attr){
					if(obj.currentStyle){
						return obj.currentStyle[attr];
						
					}else{
						return document.defaultView.getComputedStyle(obj,null)[attr]
					}
				}
				
				// 2.缩略图修改
				thumbnail();
				function thumbnail(){
					// 获取图片移动的容器
					var list=document.querySelector(".con .mainCon .previewWrap .specScroll .itemCon ul");
					// 获取图片的集合
					var items=document.querySelectorAll(".con .mainCon .previewWrap .specScroll .itemCon ul > li");
					
					// 获取左右的两个按钮
					var prev=document.querySelector(".con .mainCon .previewWrap .specScroll .prev")
					var next=document.querySelector(".con .mainCon .previewWrap .specScroll .next");
					// 定义图片显示张数
					var showImg=5;
					// 定义初始化已经走过的距离
					var tempLeft=0;
					// 获取li的marginRight   上面要定义一个方法
					var itemRight=parseInt(getStyle(items[0],"marginRight"));
					// 计算一共可以移动的距离 (中张数-显示的张数)*(图片宽+marginRight)
					
					var countLeft=(items.length-showImg)*(items[0].offsetWidth+itemRight);
					console.log(countLeft)
					// 每次移动的图片数量
					var moveNum=2;
					// 计算每次移动的长度(一个元素的长度+marginRight)*每次移动的图片数量
					var moveLeft=(items[0].offsetWidth+itemRight)*moveNum;
					// 添加过渡效果
					list.style.transition="0.2s linear";
					// 给两个按钮绑定单击事件
					// next.onclick=function(){
						
					// 	// 如果已经走过的距离小于总共可以走的距离  才能移动
					// 	if(tempLeft < countLeft){
					// 		// 剩余的距离=countLeft-tempLeft；
					// 		if(countLeft-tempLeft > moveLeft){
					// 			tempLeft+=moveLeft;
					// 			alert(tempLeft)
					// 		}else{
					// 			tempLeft+=(countLeft-moveLeft);
								
					// 		}
					// 		list.style.left=-tempLeft+"px";
					// 	}
					// }
					// prev.onclick=function(){
					// 	if(tempLeft>0){
					// 		if(tempLeft>moveLeft){
					// 			tempLeft-=moveLeft;
					// 		}else{
					// 			tempLeft=0;
					// 		}
					// 		list.style.left=-tempLeft+"px";
					// 	}
					// }
					
					next.onclick = function () {
					//                如果已经走过的距离 小于 总共可以走的距离 才能移动
					                if(tempLeft < countLeft){
					//              tempLeft = 600         countLeft = 700    走一次是200
					//               剩余的距离 = countLeft - tempLeft
					//                  如果剩余的距离大于每次可以移动的距离  则走该移动的距离(moveLeft)
					                    if(countLeft - tempLeft > moveLeft){
					                        tempLeft += moveLeft;
					                    }else{
					//                        如果剩余的距离小于每次可以移动的距离  则走剩下的所有  100
					                        tempLeft += (countLeft - tempLeft);
					                    }
					                    list.style.left = -tempLeft + 'px';
					                }
					            };
					            prev.onclick = function () {
					//             如果可移动距离还大于0  说明可以向左移动
					                if(tempLeft >0){
					//                  如果可以走的距离 大于每次移动的距离  则走该走的长度 否则直接为0
					                    if(tempLeft > moveLeft){
					                      tempLeft -= moveLeft;
					                    }else {
					                        tempLeft = 0;
					                    }
					                    list.style.left = -tempLeft + 'px';
					                }
					            }

				}
				
			})
		</script>
	</body>
</html>
